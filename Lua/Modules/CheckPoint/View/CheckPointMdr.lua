---
--- Generated by Tools
--- Created by zheng.
--- DateTime: 2020-06-19-23:48:36
---

local CheckPointItem = require("Game.Modules.CheckPoint.View.CheckPointItem")
local BaseMediator = require("Game.Core.Ioc.BaseMediator")
---@class Game.Modules.CheckPoint.View.CheckPointMdr : Game.Core.Ioc.BaseMediator
---@field checkPointModel Game.Modules.CheckPoint.Model.CheckPointModel
---@field roleModel Game.Modules.Role.Model.RoleModel
---@field arrayModel Game.Modules.Array.Model.ArrayModel
---@field checkPointService Game.Modules.CheckPoint.Service.CheckPointService
---@field currChapter ChapterData
---@field positionList Betel.UI.PositionList
local CheckPointMdr = class("Game.Modules.CheckPoint.View.CheckPointMdr",BaseMediator)

function CheckPointMdr:Ctor()
    CheckPointMdr.super.Ctor(self)
    --self.layer = UILayer.LAYER_FLOAT
end

function CheckPointMdr:OnInit()
    self.positionList = PositionList.New(self.gameObject:FindChild("List/ListView"), CheckPointItem)
    self.positionList.eventDispatcher:AddEventListener(ListViewEvent.ItemClick,self.onItemClick, self)

    self.checkPointService:getChapterInfo(self.roleModel.roleId, 100000, handler(self, self.OnChapterInfo))
end

function CheckPointMdr:OnChapterInfo(data)
    self.currChapter = self.checkPointModel.currChapter
    self.positionList:SetPosList(self.currChapter.chapterInfo.uiLayoutUrl)
    self.positionList:SetData(self.currChapter.sections)
end

function CheckPointMdr:onItemClick(event, data, index)
    self.checkPointModel.currSection = data
    navigation:Push(ViewConfig.CheckPointInfo)
end

function CheckPointMdr:On_Click_BtnBack()
    navigation:Pop(ViewConfig.CheckPoint)
end

return CheckPointMdr
