---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by zhengnan.
--- DateTime: 2019/10/26 17:36
---


---@class Game.Core.EventTrigger
---@field New() : Game.Core.EventTrigger
local EventTrigger = class("EventTrigger")

local _EventMap = {} ---@type table<string, fun()>

---
---@param type string
---@param callback fun()
---@param caller any
function EventTrigger:AddEventListener(type, callback, caller)
    if callback == nil or caller == nil then
        logError("error params! callback or caller can not be nil!")
        return
    end
    local list = _EventMap[type]
    if list == nil then
        list = {}
        _EventMap[type] = list
    else
        for i = 1, #list do
            if list[i].callback == callback and list[i].caller == caller then
                logError("re add EventListener!")
                return
            end
        end
    end
    local handler = Handler.New(callback, caller)
    table.insert(list, handler)
end

function EventTrigger:RemoveEventListener(type, callback, caller)
    if callback == nil then
        logError("error params! callback or caller can not be nil!")
        return
    end
    local list = _EventMap[type]
    if list == nil then
        return
    end
    local del = {}
    local len = #list
    for i = 1, len do
        if list[i].callback == callback and list[i].caller == caller then
            table.insert(del, i)
        end
    end
    for i = 1, #del do
        table.remove(list,del[i])
    end
end

return EventTrigger;